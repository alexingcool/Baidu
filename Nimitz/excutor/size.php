<?php
$HADOOP="/home/users/zhangliang08/hadoop-client/hadoop/bin/hadoop";
$paths = array (
        "ud_tl_ps_query_trade_ecomon" => "/log/100025586/ud_tl_ps_query_trade_ecomon",
        "important_query_url_ecomon" => "/log/100025586/important_query_url_ecomon",
        "ass_query_ecomon" => "/log/100025586/ass_query_ecomon",
        "extend_term_ecomon" => "/log/100025586/extend_term_ecomon",
        "iknow_wap_mobile_new" => "/log/1947/iknow_wap_mobile_new",
        "iknow_wap_mhome_new" => "/log/1947/iknow_wap_mhome_new",
        "iknow_wap_msearch_new" => "/log/1947/iknow_wap_msearch_new",
        "iknow_wap_mbrowse_new" => "/log/1947/iknow_wap_mbrowse_new",
        "iknow_wap_mucenter_new" => "/log/1947/iknow_wap_mucenter_new",
        "browser_useraction_udw" => "/log/17617/browser_useraction_udw",
        "browser_openweb_udw" => "/log/17617/browser_openweb_udw",
        "browser_general_udw" => "/log/17617/browser_general_udw",
        "browser_criticaltech_udw" => "/log/17617/browser_criticaltech_udw",
        "client_update_udw" => "/log/17617/client_update_udw",
        "gps_bws_udw_ecomon" => "/log/100025586/gps_bws_udw_ecomon",
        "gps_bz_udw_ecomon" => "/log/100025586/gps_bz_udw_ecomon",
        "music_play_lighttpd_access_ecomon" => "/log/19781/music_play_lighttpd_access_ecomon",
        "gps_click_udw_ecomon" => "/log/100025586/gps_click_udw_ecomon",
        "ime_commitword_log_udw" => "/log/34359/ime_commitword_log_udw",
        "setup_udw" => "/log/34359/setup_udw",
        "ime_liveuser_udwps" => "/log/34359/ime_liveuser_udwps",
        "activeuser_udwps" => "/log/34359/activeuser_udwps",
        "inputsort_udwps" => "/log/34359/inputsort_udwps",
        "day_inputword_udw" => "/log/34359/day_inputword_udw",
        "day_inputsort_udw" => "/log/34359/day_inputsort_udw",
        "day_activeuser_udw" => "/log/34359/day_activeuser_udw",
        "day_unsetup_udw" => "/log/34359/day_unsetup_udw",
        "day_ime_liveuser_udw" => "/log/34359/day_ime_liveuser_udw",
        "gps_cache_udw_ecomon" => "/log/100025586/gps_cache_udw_ecomon",
        "ting_wwwmu_ui_log_udw1" => "/log/19781/ting_wwwmu_ui_log_udw1",
        "music_yyr_lighttpd_access_udw1" => "/log/19781/music_yyr_lighttpd_access_udw1",
        "music_yyr_wwwdata_y_alys_udw1" => "/log/19781/music_yyr_wwwdata_y_alys_udw1",
        "music_ui_log_udw1" => "/log/19781/music_ui_log_udw1",
        "ting_wwwmu_alys_log_udw" => "/log/19781/ting_wwwmu_alys_log_udw",
        "lemma_baike_2_ecomon" => "/log/100025586/lemma_baike_2_ecomon",
        "iknow_wap_mmessage_new_ecommon" => "/log/1947/iknow_wap_mmessage_new_ecommon",
        "iknow_wap_mapi_new_ecomon" => "/log/1947/iknow_wap_mapi_new_ecomon",
        "apache_com_ecomon" => "/log/1947/apache_com_ecomon",
        "php_question_new" => "/log/1947/php_question_new",
        "iknow_home_new" => "/log/1947/iknow_home_new",
        "iknow_uhome_new" => "/log/1947/iknow_uhome_new",
        "iknow_browse_new" => "/log/1947/iknow_browse_new",
        "iknow_search_new" => "/log/1947/iknow_search_new",
        "iknow_submit_new_ecomon" => "/log/1947/iknow_submit_new_ecomon",
        "weibo_imei" => "/log/205/weibo_imei",
        "weibo_dav" => "/log/205/weibo_dav",
        "weibo_identity" => "/log/205/weibo_identity",
        "weibo_userinfo" => "/log/205/weibo_userinfo",
        "main_run_1001_udw" => "/log/200006912/main_run_1001_udw",
        "weibo_liveness" => "/log/205/weibo_liveness",
        "weibo_poi_history" => "/log/205/weibo_poi_history",
        "weibo_poi" => "/log/205/weibo_poi",
        "tray_run_1002_udw" => "/log/200006912/tray_run_1002_udw",
        "service_run_1003_udw" => "/log/200006912/service_run_1003_udw",
        "install_1004_udw" => "/log/200006912/install_1004_udw",
        "uninstall_1005_udw" => "/log/200006912/uninstall_1005_udw",
        "file_monitor_1007_udw" => "/log/200006912/file_monitor_1007_udw",
        "virus_report_1008_udw" => "/log/200006912/virus_report_1008_udw",
        "click_stream_1009_udw" => "/log/200006912/click_stream_1009_udw",
        "config_report_1010_udw" => "/log/200006912/config_report_1010_udw",
        "killing_report_1011_udw" => "/log/200006912/killing_report_1011_udw",
        "main_defense_statistics_1013_udw" => "/log/200006912/main_defense_statistics_1013_udw",
        "update_report_1014_udw" => "/log/200006912/update_report_1014_udw",
        "core_data_report_1024_udw" => "/log/200006912/core_data_report_1024_udw",
        "crash_realtime_report_1025_udw" => "/log/200006912/crash_realtime_report_1025_udw",
        "mini_download_1027_udw" => "/log/200006912/mini_download_1027_udw",
        "attack_defense_data_1031_udw" => "/log/200006912/attack_defense_data_1031_udw",
        "module_update_1032_udw" => "/log/200006912/module_update_1032_udw",
        "antivirus_aurora_download_1049_udw" => "/log/200006912/antivirus_aurora_download_1049_udw",
        "file_monitor_config_1018_udw" => "/log/200006912/file_monitor_config_1018_udw",
        "kaba_engine_1023_udw" => "/log/200006912/kaba_engine_1023_udw",
        "update_report_3001_udw" => "/log/200006912/update_report_3001_udw",
        "config_file_3003_udw" => "/log/200006912/config_file_3003_udw",
        "register_cancel_3004_udw" => "/log/200006912/register_cancel_3004_udw",
        "switch_setting_3005_udw" => "/log/200006912/switch_setting_3005_udw",
        "protective_log_3006_udw" => "/log/200006912/protective_log_3006_udw",
        "valid_check_3007_udw" => "/log/200006912/valid_check_3007_udw",
        "service_list_3008_udw" => "/log/200006912/service_list_3008_udw",
        "software_manager_2_udw" => "/log/200006912/software_manager_2_udw",
        "pc_speedup_3_udw" => "/log/200006912/pc_speedup_3_udw",
        "clean_5_udw" => "/log/200006912/clean_5_udw",
        "homepage_6_udw" => "/log/200006912/homepage_6_udw",
        "tray_7_udw" => "/log/200006912/tray_7_udw",
        "leak_basic_9_udw" => "/log/200006912/leak_basic_9_udw",
        "leak_exception_10_udw" => "/log/200006912/leak_exception_10_udw",
        "leak_fix_13_udw" => "/log/200006912/leak_fix_13_udw",
        "leak_display_14_udw" => "/log/200006912/leak_display_14_udw",
        "leak_extend_15_udw" => "/log/200006912/leak_extend_15_udw",
        "tips_manager_1042_udw" => "/log/200006912/tips_manager_1042_udw",
        "inter_sug_bak" => "/log/100024774/inter_sug_bak"
    );


$info=' fs -dus ';
$total = 0;
$result = array();
foreach ($paths as $key => $path) {
    $cmd=$HADOOP . $info . $path;
    exec($cmd, $output);
    $ret = explode("\t", $output[0]);
    $result[$key] = (int)$ret[1];
    $total += (int)$ret[1];
    print "!";
}
print "\n-----------------------------------------------------\n";
print "total = $total\n";
print_r($result);
